<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wika News | ÙˆÙŠÙƒØ§ Ù†ÙŠÙˆØ²</title>
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#e74c3c">
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root { --primary: #e74c3c; --bg: #0f0f0f; --card: #1a1a1a; --text: #ffffff; --dim: #b3b3b3; }
        body { font-family: 'Cairo', sans-serif; background: var(--bg); color: var(--text); margin: 0; padding: 0; line-height: 1.6; }
        
        header { background: rgba(15, 15, 15, 0.9); backdrop-filter: blur(10px); padding: 15px; text-align: center; border-bottom: 2px solid var(--primary); position: sticky; top: 0; z-index: 1000; }
        .logo-img { height: 45px; }

        .breaking-box { background: #fff; color: #000; margin: 15px; border-radius: 12px; border-right: 8px solid var(--primary); box-shadow: 0 4px 15px rgba(0,0,0,0.3); overflow: hidden; }
        .breaking-label { background: var(--primary); color: #fff; padding: 4px 15px; font-weight: bold; font-size: 0.85rem; width: fit-content; border-radius: 0 0 10px 0; }
        #ticker-text { padding: 12px; font-weight: bold; font-size: 1.05rem; transition: opacity 0.4s; min-height: 1.5em; }

        nav { background: #222; display: flex; overflow-x: auto; padding: 10px; gap: 8px; border-bottom: 1px solid #333; position: sticky; top: 77px; z-index: 999; }
        nav::-webkit-scrollbar { display: none; }
        nav button { background: #333; color: #fff; border: none; padding: 8px 20px; border-radius: 20px; cursor: pointer; white-space: nowrap; font-weight: bold; font-family: inherit; }
        nav button.active { background: var(--primary); }

        .container { padding: 15px; max-width: 800px; margin: auto; }
        .news-card { background: var(--card); border-radius: 15px; margin-bottom: 15px; display: block; border-right: 5px solid var(--primary); text-decoration: none; color: inherit; transition: 0.2s; border-top: 1px solid rgba(255,255,255,0.05); }
        .news-card:active { transform: scale(0.98); background: #222; }
        .news-body { padding: 18px; }
        .news-title { font-size: 1.15rem; font-weight: bold; color: #fff; margin: 0; line-height: 1.5; }
        .news-footer { font-size: 0.85rem; color: var(--dim); margin-top: 12px; display: flex; justify-content: space-between; align-items: center; }

        #status { text-align: center; padding: 40px; color: var(--primary); font-weight: bold; font-size: 1.2rem; }
        .load-more { display: none; width: 100%; padding: 15px; background: var(--primary); color: #fff; border: none; border-radius: 12px; font-weight: bold; cursor: pointer; margin: 20px 0; font-family: inherit; }
    </style>
</head>
<body>

<header>
    <img src="Picsart_26-01-20_05-35-29-021.png" alt="Wika News" class="logo-img">
</header>

<div class="breaking-box">
    <div class="breaking-label">Ø¹Ø§Ø¬Ù„</div>
    <div id="ticker-text">Ø¬Ø§Ø±ÙŠ Ø¬Ù„Ø¨ Ø¢Ø®Ø± Ø§Ù„Ø£Ø®Ø¨Ø§Ø±...</div>
</div>

<nav>
    <button class="active" onclick="changeCat('all', this)">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>
    <button onclick="changeCat('politics', this)">Ø³ÙŠØ§Ø³Ø©</button>
    <button onclick="changeCat('sports', this)">Ø±ÙŠØ§Ø¶Ø©</button>
    <button onclick="changeCat('economy', this)">Ø§Ù‚ØªØµØ§Ø¯</button>
</nav>

<div class="container">
    <div id="news-list"></div>
    <div id="status">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</div>
    <button id="more-btn" class="load-more" onclick="render()">Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„Ø£Ø®Ø¨Ø§Ø±</button>
</div>

<script>
    let posts = [];
    let count = 0;
    const step = 10;
    let tickerIdx = 0;

    const proxy = "https://api.allorigins.win/get?url=";
    const rss = "https://www.ina.iq/rss.xml";

    async function load(cat = 'all') {
        const list = document.getElementById('news-list');
        const status = document.getElementById('status');
        const btn = document.getElementById('more-btn');
        
        list.innerHTML = '';
        status.style.display = 'block';
        status.innerText = "Ø¬Ø§Ø±ÙŠ Ø¹Ø±Ø¶ Ø§Ù„Ø£Ø®Ø¨Ø§Ø± Ø§Ù„Ù…ØªØ§Ø­Ø©...";
        btn.style.display = 'none';

        try {
            const res = await fetch(`${proxy}${encodeURIComponent(rss)}&t=${Date.now()}`);
            const data = await res.json();
            const xml = new DOMParser().parseFromString(data.contents, "text/xml");
            const items = xml.querySelectorAll("item");

            posts = [];
            items.forEach(item => {
                const title = item.querySelector("title").textContent;
                const link = item.querySelector("link").textContent;
                
                if (cat === 'all') {
                    posts.push({ title, link });
                } else {
                    const keys = {
                        politics: ['Ø³ÙŠØ§Ø³', 'Ø­ÙƒÙˆÙ…', 'Ù…Ø¬Ù„Ø³', 'ÙˆØ²ÙŠØ±'],
                        sports: ['Ø±ÙŠØ§Ø¶', 'ÙƒØ±Ø©', 'Ù…Ù†ØªØ®Ø¨', 'Ù†Ø§Ø¯ÙŠ'],
                        economy: ['Ø§Ù‚ØªØµØ§Ø¯', 'Ù…Ø§Ù„', 'Ø¯ÙˆÙ„Ø§Ø±', 'Ø³Ø¹Ø±']
                    };
                    if (keys[cat].some(k => title.includes(k))) posts.push({ title, link });
                }
            });

            status.style.display = 'none';
            count = 0;
            render();
            if(cat === 'all') startTicker();
        } catch (e) {
            status.innerText = "Ø¬Ø§Ø±ÙŠ Ø¹Ø±Ø¶ Ø§Ù„Ø£Ø®Ø¨Ø§Ø± Ø§Ù„Ù…ØªØ§Ø­Ø©...";
        }
    }

    function render() {
        const list = document.getElementById('news-list');
        const btn = document.getElementById('more-btn');
        const chunk = posts.slice(count, count + step);
        
        chunk.forEach(p => {
            list.innerHTML += `
                <a href="${p.link}" target="_blank" class="news-card">
                    <div class="news-body">
                        <h3 class="news-title">${p.title}</h3>
                        <div class="news-footer">
                            <span style="color:var(--primary); font-weight:700;">ğŸ•’ ÙˆÙƒØ§Ù„Ø© ÙˆØ§Ø¹</span>
                            <span>ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø®Ø¨Ø± â†</span>
                        </div>
                    </div>
                </a>
            `;
        });

        count += step;
        btn.style.display = count < posts.length ? 'block' : 'none';
    }

    function startTicker() {
        const el = document.getElementById('ticker-text');
        if(!posts.length) return;
        el.innerText = posts[0].title;
        if(window.timer) clearInterval(window.timer);
        window.timer = setInterval(() => {
            el.style.opacity = 0;
            setTimeout(() => {
                tickerIdx = (tickerIdx + 1) % Math.min(posts.length, 12);
                el.innerText = posts[tickerIdx].title;
                el.style.opacity = 1;
            }, 400);
        }, 6000);
    }

    function changeCat(cat, btn) {
        document.querySelectorAll('nav button').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        load(cat);
    }

    load();
</script>
</body>
</html>