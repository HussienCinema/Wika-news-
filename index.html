<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wika News | ÙˆÙŠÙƒØ§ Ù†ÙŠÙˆØ² Ø§Ù„Ø´Ø§Ù…Ù„</title>
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#e74c3c">
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&display=swap" rel="stylesheet">
    <link href="https://vjs.zencdn.net/7.20.3/video-js.css" rel="stylesheet" />
    <style>
        :root { --primary: #e74c3c; --bg: #0a0a0a; --surface: #1a1a1a; --text: #ffffff; }
        body { font-family: 'Cairo', sans-serif; background: var(--bg); color: var(--text); margin: 0; padding: 0; overflow-x: hidden; }
        header { background: #000; padding: 15px; text-align: center; border-bottom: 2px solid var(--primary); position: sticky; top: 0; z-index: 1000; }
        .logo-img { height: 40px; }
        .live-btn { position: fixed; bottom: 20px; left: 20px; background: var(--primary); color: white; padding: 12px 25px; border-radius: 50px; font-weight: 900; box-shadow: 0 5px 15px rgba(231, 76, 60, 0.4); cursor: pointer; z-index: 1001; display: flex; align-items: center; gap: 8px; }
        .iptv-overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #000; z-index: 2000; overflow-y: auto; }
        .modal-header { padding: 15px; display: flex; justify-content: space-between; align-items: center; background: #111; }
        .video-box { width: 100%; max-width: 900px; margin: auto; aspect-ratio: 16/9; background: #000; }
        .channels-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(110px, 1fr)); gap: 10px; padding: 15px; }
        .ch-item { background: #222; padding: 12px; border-radius: 10px; text-align: center; cursor: pointer; font-size: 0.8rem; font-weight: bold; border: 1px solid transparent; }
        .ch-item:hover { border-color: var(--primary); }
        nav { background: #111; display: flex; overflow-x: auto; padding: 10px; gap: 10px; position: sticky; top: 72px; z-index: 999; border-bottom: 1px solid #222; }
        nav::-webkit-scrollbar { display: none; }
        nav button { background: #222; color: #fff; border: none; padding: 8px 18px; border-radius: 20px; cursor: pointer; white-space: nowrap; font-family: inherit; font-weight: bold; }
        nav button.active { background: var(--primary); }
        .container { padding: 15px; max-width: 800px; margin: auto; min-height: 400px; }
        .news-card { background: var(--surface); border-radius: 15px; padding: 18px; margin-bottom: 15px; border-right: 5px solid var(--primary); text-decoration: none; color: inherit; display: block; }
        #loading-info { text-align: center; padding: 40px; color: var(--primary); font-weight: bold; }
        .load-more-btn { display: none; width: 100%; padding: 15px; background: var(--primary); color: #fff; border: none; border-radius: 12px; font-weight: bold; cursor: pointer; margin: 20px 0; font-family: inherit; }
    </style>
</head>
<body>

<header><img src="Picsart_26-01-20_05-35-29-021.png" alt="Wika News" class="logo-img"></header>

<div class="live-btn" onclick="openLive()"><div style="height:10px; width:10px; background:#fff; border-radius:50%;"></div><span>Ø§Ù„Ø¨Ø« Ø§Ù„Ù…Ø¨Ø§Ø´Ø±</span></div>

<div id="iptvOverlay" class="iptv-overlay">
    <div class="modal-header"><span style="font-weight:900; color:var(--primary);">ØªÙ„ÙØ²ÙŠÙˆÙ† ÙˆÙŠÙƒØ§ Ù†ÙŠÙˆØ²</span><button onclick="closeLive()" style="background:none; border:none; color:white; font-size:2.5rem; cursor:pointer;">&times;</button></div>
    <div class="video-box"><video id="iptv-player" class="video-js vjs-default-skin vjs-big-play-centered" controls preload="auto" style="width:100%; height:100%;"></video></div>
    <div class="channels-grid" id="channelsGrid"></div>
</div>

<nav>
    <button class="active" onclick="changeCategory('all', this)">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>
    <button onclick="changeCategory('iraq', this)">Ø£Ø®Ø¨Ø§Ø± Ø§Ù„Ø¹Ø±Ø§Ù‚</button>
    <button onclick="changeCategory('world', this)">Ø£Ø®Ø¨Ø§Ø± Ø§Ù„Ø¹Ø§Ù„Ù…</button>
    <button onclick="changeCategory('sports', this)">Ø±ÙŠØ§Ø¶Ø©</button>
</nav>

<div class="container">
    <div id="loading-info">Ø¬Ø§Ø±ÙŠ Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„Ø£Ø®Ø¨Ø§Ø± ÙˆØ§Ù„Ù…ØµØ§Ø¯Ø±...</div>
    <div id="news-feed"></div>
    <button id="btn-more" class="load-more-btn" onclick="render()">Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø²ÙŠØ¯</button>
</div>

<script src="https://vjs.zencdn.net/7.20.3/video.min.js"></script>
<script>
    const channels = [
        { name: "Ø§Ù„Ø¹Ø±Ø§Ù‚ÙŠØ© Ø§Ù„Ø¥Ø®Ø¨Ø§Ø±ÙŠØ©", url: "https://imn.m3u8.xyz/live/news/index.m3u8" },
        { name: "Ø§Ù„Ø¬Ø²ÙŠØ±Ø© Ù…Ø¨Ø§Ø´Ø±", url: "https://live-hls-web-ajm.getaj.net/AJM/index.m3u8" },
        { name: "Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ø­Ø¯Ø«", url: "https://alarabiya.m3u8.xyz/live/alhadath/index.m3u8" },
        { name: "Ø³ÙƒØ§ÙŠ Ù†ÙŠÙˆØ² Ø¹Ø±Ø¨ÙŠØ©", url: "https://skynews.m3u8.xyz/live/live/index.m3u8" },
        { name: "Ø§Ù„Ø±Ø§Ø¨Ø¹Ø© Ø§Ù„Ø¥Ø®Ø¨Ø§Ø±ÙŠØ©", url: "https://alrabiaa.m3u8.xyz/live/live/index.m3u8" },
        { name: "Ù‚Ù†Ø§Ø© Ø§Ù„Ø´Ø±Ù‚ÙŠØ© Ù†ÙŠÙˆØ²", url: "https://asharqia.m3u8.xyz/live/live/index.m3u8" },
        { name: "ØªÙ„ÙØ²ÙŠÙˆÙ† Ø§Ù„Ø¹Ø±Ø¨ÙŠ", url: "https://alaraby.m3u8.xyz/live/live/index.m3u8" },
        { name: "Ù‚Ù†Ø§Ø© Ø¯Ø¬Ù„Ø© Ù†ÙŠÙˆØ²", url: "https://dijlah.m3u8.xyz/live/news/index.m3u8" }
    ];

    let allPosts = [];
    let currentIdx = 0;
    const player = videojs('iptv-player');

    async function loadNews(cat = 'all') {
        const feed = document.getElementById('news-feed');
        const info = document.getElementById('loading-info');
        const btn = document.getElementById('btn-more');
        feed.innerHTML = '';
        info.style.display = 'block';
        btn.style.display = 'none';

        try {
            const urls = ["https://www.ina.iq/rss.xml", "https://www.aljazeera.net/aljazeerarss.xml"];
            const results = await Promise.all(urls.map(u => fetch(`https://api.allorigins.win/get?url=${encodeURIComponent(u)}&t=${Date.now()}`).then(r => r.json())));

            allPosts = [];
            results.forEach((res, i) => {
                const xml = new DOMParser().parseFromString(res.contents, "text/xml");
                const items = xml.querySelectorAll("item");
                const tag = i === 0 ? "Ø§Ù„Ø¹Ø±Ø§Ù‚" : "Ø§Ù„Ø¹Ø§Ù„Ù…";
                items.forEach(item => {
                    const title = item.querySelector("title").textContent;
                    const link = item.querySelector("link").textContent;
                    if (cat === 'all' || (cat === 'iraq' && tag === 'Ø§Ù„Ø¹Ø±Ø§Ù‚') || (cat === 'world' && tag === 'Ø§Ù„Ø¹Ø§Ù„Ù…') || (cat === 'sports' && (title.includes('Ø±ÙŠØ§Ø¶') || title.includes('ÙƒØ±Ø©')))) {
                        allPosts.push({title, link, tag});
                    }
                });
            });

            info.style.display = 'none';
            currentIdx = 0;
            render();
        } catch (e) { info.innerText = "ØªØ¹Ø°Ø± Ø¬Ù„Ø¨ Ø§Ù„Ø£Ø®Ø¨Ø§Ø±ØŒ ÙŠØ±Ø¬Ù‰ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø©."; }
    }

    function render() {
        const feed = document.getElementById('news-feed');
        const btn = document.getElementById('btn-more');
        const chunk = allPosts.slice(currentIdx, currentIdx + 12);
        chunk.forEach(p => { feed.innerHTML += `<a href="${p.link}" target="_blank" class="news-card"><span style="color:var(--primary); font-size:0.75rem; font-weight:bold;">ğŸ“ ${p.tag}</span><h3 style="margin:5px 0 0; font-size:1.1rem;">${p.title}</h3></a>`; });
        currentIdx += 12;
        btn.style.display = currentIdx < allPosts.length ? 'block' : 'none';
    }

    function openLive() { document.getElementById('iptvOverlay').style.display = 'block'; play(channels[0].url); }
    function closeLive() { document.getElementById('iptvOverlay').style.display = 'none'; player.pause(); }
    function play(url) { player.src({ type: 'application/x-mpegURL', src: url }); player.play(); }

    const grid = document.getElementById('channelsGrid');
    channels.forEach(ch => {
        const div = document.createElement('div');
        div.className = 'ch-item';
        div.onclick = () => play(ch.url);
        div.innerText = ch.name;
        grid.appendChild(div);
    });

    function changeCategory(cat, btn) {
        document.querySelectorAll('nav button').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        loadNews(cat);
    }

    loadNews();
</script>
</body>
</html>